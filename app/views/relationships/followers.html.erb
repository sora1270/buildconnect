<div class="container mt-5">
  <div class="row">
    <div class="col-md-3">
      <!-- サイドバー: プロフィール情報 -->
      <div class="card mb-3">
        <div class="card-body text-center">
          <% if current_user.profile_image.attached? %>
            <%= image_tag current_user.profile_image, size: "150x150", class: 'img-thumbnail' %>
          <% else %>
            <%= image_tag 'no_image', size: "150x150", class: 'img-thumbnail' %>
          <% end %>
          <h3 class="mt-2"><%= current_user.full_name %></h3>
          <p class="text-muted"><%= current_user.company_name %></p>
          <p><%= current_user.email %></p>

          <!-- フォロー数とフォロワー数 -->
          <div class="mt-3">
            <%= link_to "フォロー数: #{current_user.followings.count}", followings_user_path(current_user), class: 'btn btn-primary btn-block' %>
          </div>
          <div class="mt-2">
            <%= link_to "フォロワー数: #{current_user.followers.count}", followers_user_path(current_user), class: 'btn btn-primary btn-block' %>
          </div>

          <!-- ユーザー編集ボタン -->
          <div class="mt-3">
            <%= link_to 'プロフィール編集', edit_user_registration_path, class: 'btn btn-primary btn-block' %>
          </div>
          
          <!-- アカウント削除ボタン -->
          <div class="mt-2">
            <%= button_to 'アカウント削除', registration_path(current_user), method: :delete, data: { confirm: '本当にアカウントを削除しますか？' }, class: 'btn btn-danger btn-block' %>
          </div>
        </div>
      </div>
    </div>

    <!-- フォロワーリスト -->
    <div class="col-md-9">
      <h2>フォロワー一覧</h2>
      <div class="row">
        <% @users.each do |user| %>
          <div class="col-md-4 mb-3">
            <div class="card">
              <div class="card-body text-center">
                <% if user.profile_image.attached? %>
                  <%= image_tag user.profile_image, size: "100x100", class: 'img-thumbnail' %>
                <% else %>
                  <%= image_tag 'no_image', size: "100x100", class: 'img-thumbnail' %>
                <% end %>
                <h5 class="mt-2"><%= link_to user.full_name, user_path(user) %></h5>
                <p class="text-muted"><%= user.company_name %></p>
                <p><%= user.email %></p>

                <% if current_user != user %>
                  <% if current_user.following?(user) %>
                    <%= link_to "フォロー外す", relationship_path(current_user.active_relationships.find_by(followed_id: user.id)), method: :delete, class: "btn btn-info btn-sm" %>
                  <% else %>
                    <%= link_to "フォローする", relationships_path(followed_id: user.id), method: :post, class: "btn btn-success btn-sm" %>
                  <% end %>
                <% end %>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>